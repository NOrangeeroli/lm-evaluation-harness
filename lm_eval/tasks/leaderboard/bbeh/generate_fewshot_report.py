#!/usr/bin/env python3
"""Generate a markdown report with fewshot prompts for all BBEH tasks."""

import datasets
from pathlib import Path

# Get the directory where this script is located
SCRIPT_DIR = Path(__file__).parent

def load_bbeh_dataset():
    """Load the BBEH dataset and extract all unique task names."""
    print("Loading BBEH/bbeh dataset...")
    dataset = datasets.load_dataset("BBEH/bbeh", split="train")
    
    # Get unique task names
    unique_tasks = set()
    tasks_examples = {}
    
    for example in dataset:
        task_name = example.get("task", None)
        if task_name:
            unique_tasks.add(task_name)
            if task_name not in tasks_examples:
                tasks_examples[task_name] = []
            tasks_examples[task_name].append(example)
    
    return sorted(unique_tasks), tasks_examples

def generate_fewshot_prompts(task_name, examples):
    """Generate fewshot prompts that demonstrate the task without using dataset examples."""
    
    # Get first example to understand the format
    first_ex = examples[0] if examples else None
    if not first_ex:
        return []
    
    input_text = first_ex['input']
    target_text = first_ex['target']
    
    # Generate task-appropriate fewshot examples
    fewshot_examples = []
    
    if task_name == "boolean expressions":
        fewshot_examples = [
            {"input": "From the following five expressions, only one evaluates to true. Which one is it?\n\n(A) not (not (False) or (5 * 2 > 8)) and (True) or (False)\n(B) not (not (True) and (3 + 4 <= 6)) or (False) and (True)\n(C) not (not (not (False)) or (2 * 3 is greater than 5)) and (The capital of France is Paris.)\n(D) (False) or (False) and (True) or not (True)\n(E) not (not (True) or (False)) and (4 - 2 > 1)", "target": "(E)"},
            {"input": "From the following five expressions, only one evaluates to true. Which one is it?\n\n(A) not (not (not (True)) or (6 / 2 <= 2)) and (False)\n(B) (True) and (False) or not (True) and (False)\n(C) not (not (False) and (5 + 3 > 7)) or (The capital of Spain is Madrid.)\n(D) not (not (not (False)) and (8 - 4 is less than or equal to 3)) or (True)\n(E) (False) or (False) and not (True)", "target": "(D)"},
            {"input": "From the following five expressions, only one evaluates to true. Which one is it?\n\n(A) not (not (True) or (2 * 5 > 12)) and (False) or (True)\n(B) (False) and (True) or not (False) and (True)\n(C) not (not (not (True)) or (10 - 3 <= 6)) and (The capital of Germany is Berlin.)\n(D) not (not (False) and (4 * 2 is greater than 7)) or (False)\n(E) (True) or (False) and (False)", "target": "(C)"}
        ]
    elif task_name == "causal understanding":
        fewshot_examples = [
            {"input": "Question: John flipped the light switch. The light turned on immediately. Did John cause the light to turn on? Reply Yes or No based on the answer the majority of people would give. If you think people would be split roughly 50-50 between Yes and No then reply Ambiguous.", "target": "Yes"},
            {"input": "Question: Mary planted a seed in the garden. A week later, a flower grew in that spot. Did Mary cause the flower to grow? Reply Yes or No based on the answer the majority of people would give. If you think people would be split roughly 50-50 between Yes and No then reply Ambiguous.", "target": "Yes"},
            {"input": "Question: Tom thought about rain. Five minutes later, it started raining outside. Did Tom cause it to rain? Reply Yes or No based on the answer the majority of people would give. If you think people would be split roughly 50-50 between Yes and No then reply Ambiguous.", "target": "No"}
        ]
    elif task_name == "disambiguation qa":
        fewshot_examples = [
            {"input": "Here is a sentence with pronoun(s) whose antecedent(s) can either be derived from the context or is ambiguous.\nSentence: The doctor called the nurse and asked her to bring the chart.\nWhich of the following options correctly explains the antecedent(s) of the pronoun(s)?\n(A) The doctor asked the nurse to bring the chart.\n(B) The nurse asked the doctor to bring the chart.\n(C) The doctor asked herself to bring the chart.\n(D) The nurse asked herself to bring the chart.\n(E) Ambiguous.", "target": "(A)"},
            {"input": "Here is a sentence with pronoun(s) whose antecedent(s) can either be derived from the context or is ambiguous.\nSentence: The teacher told the student that he should study more.\nWhich of the following options correctly explains the antecedent(s) of the pronoun(s)?\n(A) The student should study more.\n(B) The teacher should study more.\n(C) Both should study more.\n(D) Neither should study more.\n(E) Ambiguous.", "target": "(A)"},
            {"input": "Here is a sentence with pronoun(s) whose antecedent(s) can either be derived from the context or is ambiguous.\nSentence: The manager spoke to the employee about his performance.\nWhich of the following options correctly explains the antecedent(s) of the pronoun(s)?\n(A) The manager's performance was discussed.\n(B) The employee's performance was discussed.\n(C) Both performances were discussed.\n(D) Neither performance was discussed.\n(E) Ambiguous.", "target": "(B)"}
        ]
    elif task_name == "geometric shapes":
        fewshot_examples = [
            {"input": "Suppose we draw this SVG path element: M 0,0 L 10,0 L 10,10 L 0,10 Z. Out of the following shapes:\n1. rectangle that is not a square and with no diagonals drawn\n2. square with no diagonals drawn\n3. triangle that is not a right triangle\n4. right triangle\n5. parallelogram that is not a rectangle and with no diagonals drawn\n6. trapezoid with exactly one pair of parallel sides and with no diagonals drawn\n7. irregular convex pentagon with no diagonals drawn\n8. irregular concave pentagon with no diagonals drawn\n9. regular pentagon with no diagonals drawn\n10. regular hexagon with no diagonals drawn\nwhich one(s) can be viewed when the lines in the SVG are visualized? Note that a shape with n sides should not necessarily be drawn by n lines; e.g., a triangle might be drawn by 4 lines, two of which collinear.\nOptions:\n(A) only 2\n(B) none of the above\n(C) only 1\n(D) 1 and 2\n(E) only 3\n(F) 2 and 3\n(G) only 4\n(H) 1 and 3\n(I) 3 and 4\n(J) only 5\n(K) 2 and 5\n(L) 1 and 5\n(M) only 6\n(N) 2 and 6\n(O) 1 and 6\n(P) 3 and 6\nCoordinates have been rounded to 5 decimal places so ignore slight differences.", "target": "(A)"},
            {"input": "Suppose we draw this SVG path element: M 5,0 L 10,10 L 0,10 Z. Out of the following shapes:\n1. rectangle that is not a square and with no diagonals drawn\n2. square with no diagonals drawn\n3. triangle that is not a right triangle\n4. right triangle\n5. parallelogram that is not a rectangle and with no diagonals drawn\n6. trapezoid with exactly one pair of parallel sides and with no diagonals drawn\n7. irregular convex pentagon with no diagonals drawn\n8. irregular concave pentagon with no diagonals drawn\n9. regular pentagon with no diagonals drawn\n10. regular hexagon with no diagonals drawn\nwhich one(s) can be viewed when the lines in the SVG are visualized? Note that a shape with n sides should not necessarily be drawn by n lines; e.g., a triangle might be drawn by 4 lines, two of which collinear.\nOptions:\n(A) only 3\n(B) none of the above\n(C) only 4\n(D) 3 and 4\n(E) only 1\n(F) 1 and 3\n(G) only 2\n(H) 2 and 3\n(I) 1 and 4\n(J) only 5\n(K) 3 and 5\n(L) 4 and 5\n(M) only 6\n(N) 3 and 6\n(O) 4 and 6\n(P) 1 and 6\nCoordinates have been rounded to 5 decimal places so ignore slight differences.", "target": "(C)"},
            {"input": "Suppose we draw this SVG path element: M 0,5 A 5,5 0 1,1 10,5 A 5,5 0 1,1 0,5 Z. Out of the following shapes:\n1. rectangle that is not a square and with no diagonals drawn\n2. square with no diagonals drawn\n3. triangle that is not a right triangle\n4. right triangle\n5. parallelogram that is not a rectangle and with no diagonals drawn\n6. trapezoid with exactly one pair of parallel sides and with no diagonals drawn\n7. irregular convex pentagon with no diagonals drawn\n8. irregular concave pentagon with no diagonals drawn\n9. regular pentagon with no diagonals drawn\n10. regular hexagon with no diagonals drawn\nwhich one(s) can be viewed when the lines in the SVG are visualized? Note that a shape with n sides should not necessarily be drawn by n lines; e.g., a triangle might be drawn by 4 lines, two of which collinear.\nOptions:\n(A) only 1\n(B) none of the above\n(C) only 2\n(D) 1 and 2\n(E) only 3\n(F) 1 and 3\n(G) only 4\n(H) 2 and 3\n(I) 3 and 4\n(J) only 5\n(K) 1 and 5\n(L) 2 and 5\n(M) only 6\n(N) 1 and 6\n(O) 2 and 6\n(P) 3 and 6\nCoordinates have been rounded to 5 decimal places so ignore slight differences.", "target": "(B)"}
        ]
    elif task_name == "hyperbaton":
        fewshot_examples = [
            {"input": "In a variant of English, we are given that the following sentences have correct adjective order:\n(1) prismlike obnoxious bowl (2) repulsive guitar (3) spherical terrible guitar (4) archaic cyan earring (5) pyramidal key (6) cardboard vietnamese cup (7) steel flower pot (8) circular ruler (9) terrible shirt (10) old-fashioned shoe (11) russian pen (12) brand-new dog (13) circular banana (14) triangular pencil (15) new sunglasses (16) archaic clock (17) brand-new bag (18) magenta fire extinguisher (19) new ball (20) smoking box (21) japanese speaker (22) chinese bowl (23) triangular hammer (24) old-fashioned crimson pen (25) wool japanese spoon\n\nIn this variant of English, which of the following sentences (Options A-J) use the correct adjective order? If none of the sentences (Options A-J) use the correct adjective order, select option K. Select all that apply.\n(A) midsize exercise paper congolese old-fashioned blue prismlike screwdriver\n(B) normal-size drinking wool iranian new indigo ridiculous circular bicycle\n(C) glass german old gray repulsive spherical lamp\n(D) mysterious prismlike cloth mexican new pink snorkeling tiny car\n(E) tiny whittling iron thai archaic magenta saw\n(F) triangular nice wool nigerian old black hammer\n(G) triangular iron egyptian archaic yellow hiking midsize box\n(H) midsize driving paper bangladeshi brand-new pink obnoxious bird\n(I) drinking wood chinese old-fashioned maroon spherical lovely scissors\n(J) obnoxious spherical paper pakistani old-fashioned pink eating chair\n(K) None of the above\n\nProvide your final answer as a concatenation of all the correct choices. For example, if B and C have correct adjective order, then your final answer must be \"BC\".", "target": "E"},
            {"input": "In a variant of English, we are given that the following sentences have correct adjective order:\n(1) brand-new leather ruler (2) congolese violet bag (3) pink bird (4) brand-new ball (5) red book (6) red wrench (7) rectangular ball (8) pyramidal good key (9) old paper chair (10) brand-new paper piano (11) prismlike umbrella (12) ethiopian pink drill (13) blue car (14) whittling bowl (15) indonesian green speaker (16) blue bottle (17) thai brown hammer (18) drinking normal-size guitar (19) smoking enormous canvas (20) square jar (21) new wrench (22) circular terrible banana (23) ancient ball (24) nigerian fire extinguisher (25) tiny bird\n\nIn this variant of English, which of the following sentences (Options A-J) use the correct adjective order? If none of the sentences (Options A-J) use the correct adjective order, select option K. Select all that apply.\n(A) green ethiopian exercise tiny pyramidal awful paper cup\n(B) old-fashioned cloth snorkeling small triangular awful turkish vase\n(C) russian violet snorkeling little circular ridiculous cardboard shirt\n(D) archaic steel drinking huge pyramidal repulsive nigerian blue hammer\n(E) brand-new plastic snorkeling large spherical good candle\n(F) crimson thai eating enormous square awful piano\n(G) american pink snorkeling medium-size spherical wonderful fork\n(H) pakistani white eating midsize circular awful cloth archaic chair\n(I) cloth smoking medium-size circular silly teal vietnamese camera\n(J) japanese driving huge prismlike obnoxious fiberglass old sunglasses\n(K) None of the above\n\nProvide your final answer as a concatenation of all the correct choices. For example, if B and C have correct adjective order, then your final answer must be \"BC\".", "target": "E"},
            {"input": "In a variant of English, we are given that the following sentences have correct adjective order:\n(1) iron egyptian earring (2) new camera (3) large yellow necklace (4) cloth sunglasses (5) tiny cyan shoe (6) yellow key (7) snorkeling spherical screwdriver (8) congolese plate (9) small screwdriver (10) archaic terrible vase (11) brand-new fire extinguisher (12) little crimson pen (13) repulsive bowl (14) ancient jar (15) old wonderful trash can (16) fiberglass bangladeshi fork (17) american bottle (18) paper fire extinguisher (19) ridiculous car (20) teal hammer (21) archaic fire extinguisher (22) new spoon (23) walking plate (24) iranian spoon (25) teal ring\n\nIn this variant of English, which of the following sentences (Options A-J) use the correct adjective order? If none of the sentences (Options A-J) use the correct adjective order, select option K. Select all that apply.\n(A) yellow enormous snorkeling circular rubber nigerian awful table\n(B) obnoxious drinking circular glass congolese teal little wallet\n(C) big green hiking rectangular wood russian repulsive jar\n(D) repulsive walking circular wood congolese midsize blue chair\n(E) new obnoxious drinking pyramidal iron mexican small black piano\n(F) yellow hiking prismlike steel nigerian silly old sunglasses\n(G) new wonderful eating triangular leather egyptian house\n(H) large red snorkeling prismlike paper chinese silly archaic plate\n(I) old nice typing spherical glass filipino blue dog\n(J) old-fashioned terrible walking square plastic american massive knife\n(K) None of the above\n\nProvide your final answer as a concatenation of all the correct choices. For example, if B and C have correct adjective order, then your final answer must be \"BC\".", "target": "G"}
        ]
    elif task_name == "movie recommendation":
        fewshot_examples = [
            {"input": "Which option has more similar movies in terms of whether a group of people will like them or not?\nOptions:\n(A) The Matrix, Inception, Interstellar, Blade Runner, The Terminator\n(B) The Matrix, Inception, The Notebook, Blade Runner, The Terminator\n(C) The Matrix, Inception, Interstellar, Blade Runner, Titanic\n(D) The Matrix, Inception, Interstellar, The Notebook, The Terminator\n(E) The Matrix, Inception, Interstellar, Blade Runner, The Terminator\n(F) The Matrix, Blade Runner, Interstellar, The Terminator, The Notebook\n(G) The Notebook, The Terminator, Interstellar, Blade Runner, The Matrix\n(H) The Terminator, The Notebook, Blade Runner, The Matrix, Inception\n(I) The Terminator, The Notebook, The Matrix, Blade Runner, Inception\n(J) The Terminator, Blade Runner, The Matrix, Inception, The Notebook", "target": "(A)"},
            {"input": "Which option has more similar movies in terms of whether a group of people will like them or not?\nOptions:\n(A) The Notebook, Titanic, Pretty Woman, When Harry Met Sally, Sleepless in Seattle\n(B) The Notebook, Titanic, The Matrix, When Harry Met Sally, Sleepless in Seattle\n(C) The Notebook, Titanic, Pretty Woman, The Terminator, Sleepless in Seattle\n(D) The Notebook, The Matrix, Pretty Woman, When Harry Met Sally, Sleepless in Seattle\n(E) The Notebook, Titanic, Pretty Woman, When Harry Met Sally, Blade Runner\n(F) The Notebook, Blade Runner, Pretty Woman, When Harry Met Sally, Titanic\n(G) Sleepless in Seattle, Blade Runner, Pretty Woman, When Harry Met Sally, The Notebook\n(H) When Harry Met Sally, Blade Runner, Pretty Woman, The Notebook, Titanic\n(I) When Harry Met Sally, Blade Runner, The Notebook, Pretty Woman, Titanic\n(J) Blade Runner, Pretty Woman, The Notebook, Titanic, When Harry Met Sally", "target": "(A)"},
            {"input": "Which option has more similar movies in terms of whether a group of people will like them or not?\nOptions:\n(A) The Shining, The Exorcist, Halloween, A Nightmare on Elm Street, Friday the 13th\n(B) The Shining, The Exorcist, The Matrix, A Nightmare on Elm Street, Friday the 13th\n(C) The Shining, The Exorcist, Halloween, The Notebook, Friday the 13th\n(D) The Shining, Inception, Halloween, A Nightmare on Elm Street, Friday the 13th\n(E) The Shining, The Exorcist, Halloween, A Nightmare on Elm Street, Titanic\n(F) The Shining, Titanic, Halloween, A Nightmare on Elm Street, The Exorcist\n(G) Friday the 13th, Titanic, Halloween, A Nightmare on Elm Street, The Shining\n(H) A Nightmare on Elm Street, Titanic, Halloween, The Shining, The Exorcist\n(I) A Nightmare on Elm Street, Titanic, The Shining, Halloween, The Exorcist\n(J) Titanic, Halloween, The Shining, The Exorcist, A Nightmare on Elm Street", "target": "(A)"}
        ]
    elif task_name == "object counting":
        fewshot_examples = [
            {"input": "My aunt has 5 apples. My uncle has 3 oranges. My uncle also has 2 bananas. My aunt also has 4 grapes. I have 6 pears. My uncle also has 1 peach. My brother has 7 apricots. My sister has 8 cherries. I also have 9 strawberries. I also have 10 blueberries. How many fruits are there in total?", "target": "55"},
            {"input": "My mother has 12 cats. My father has 8 dogs. My father also has 5 birds. My mother also has 3 hamsters. I have 15 fish. My father also has 7 rabbits. My brother has 20 mice. My sister has 11 guinea pigs. I also have 9 turtles. I also have 6 lizards. How many animals are there in total?", "target": "96"},
            {"input": "My teacher has 10 red balls. My friend has 5 blue balls. My friend also has 3 green balls. My teacher also has 7 yellow balls. I have 12 orange balls. My friend also has 4 purple balls. My classmate has 8 pink balls. My neighbor has 6 black balls. I also have 9 white balls. I also have 11 brown balls. How many balls are there in total?", "target": "75"}
        ]
    elif task_name == "sportqa":
        fewshot_examples = [
            {"input": "You will be given a main question and two sub-questions. Each question comes with multiple choices you can select from. For each question, select all the correct choices.\n\nMain Question: How would the outcome of a play differ if a receiver catches the football with both feet in bounds at the opponent's 1-yard line but subsequently steps out of bounds with possession in the end zone, as opposed to him catching the ball with both feet in bounds while already in the end zone, considering the NFL's completion of catch and touchdown rules?  A) The outcome would be a touchdown in both scenarios. B) The outcome would be a touchdown only for the catch made in the end zone. C) The outcome would be a touchdown only for the catch made at the 1-yard line with subsequent stepping out of bounds in the end zone. D) Neither scenario would result in a touchdown.\nSub-Question 1: How is a catch defined according to NFL rules when a player is near the boundary lines?  A) A catch is defined by maintaining control of the ball and having both feet or any part of the body other than the hands in bounds. B) A catch is defined by maintaining control of the ball with at least one foot in bounds. C) A catch is defined by touching the boundary line with the ball while in control of it. D) A catch is defined by maintaining control of the ball, regardless of the player's position in relation to the boundary lines.\nSub-Question 2: According to NFL rules, when is a touchdown scored in the context of boundary rules?  A) A touchdown is scored when a player steps out of bounds with the ball in the end zone after establishing possession in the field of play. B) A touchdown is scored when a player establishes possession of the ball in the end zone, regardless of where the catch originated. C) A touchdown is scored when a player catches the ball and maintains possession with at least one foot touching the end zone boundary line. D) A touchdown is scored when a player maintains possession of the ball while any part of the body is over the end zone boundary line in the air.\n\nFor each question, provide the answer as a concatenation of the correct choices.\nSeparate the answers for the questions by comma.\nFor example, if the correct choices for the main question are A and C, for the first sub-question is D and for the second sub-question are B and D, your final answer must be \"AC, D, BD\".", "target": "A, A, A"},
            {"input": "You will be given a main question and two sub-questions. Each question comes with multiple choices you can select from. For each question, select all the correct choices.\n\nMain Question: How would the enforcement of penalties be affected if a defensive player commits a holding penalty on a wide receiver during a successful Hail Mary pass on the last play of the fourth quarter where the offense is trailing by four points, but the offense had previously committed a false start that was unobserved by the officials?  A) The game would end with the offense being awarded a touchdown due to the defensive holding penalty. B) The defense would be penalized, but the touchdown would be negated due to the previous unobserved false start. C) Both penalties would offset and the offense would be given one untimed down to replay the final play. D) The defense would accept the result of the play, and the game would end without acknowledging the false start.\nSub-Question 1: In American football, what is the usual consequence of a defensive holding penalty that occurs during a successful pass play?  A) The offense is awarded the yardage gained plus a 5-yard penalty and an automatic first down. B) The defense is penalized half the distance to the goal line, but no automatic first down is awarded. C) The offense is awarded a 10-yard penalty and an automatic first down. D) The play is nullified, and the offense is awarded a 5-yard penalty with a replay of the down.\nSub-Question 2: According to the rules, how are unobserved penalties typically handled if discovered after a play has concluded?  A) They are enforced if they are reviewable under the instant replay system. B) They are disregarded since they were not called during the play. C) They result in a fine or disciplinary action against the officials after the game. D) They can lead to a replay of the down if the opposing coach challenges the play.\n\nFor each question, provide the answer as a concatenation of the correct choices.\nSeparate the answers for the questions by comma.\nFor example, if the correct choices for the main question are A and C, for the first sub-question is D and for the second sub-question are B and D, your final answer must be \"AC, D, BD\".", "target": "C, A, A"},
            {"input": "You will be given a main question and two sub-questions. Each question comes with multiple choices you can select from. For each question, select all the correct choices.\n\nMain Question: What outcome would likely be the result if, during an NFL playoff game, a Replay Officials review is initiated for a contested touchdown pass that was initially ruled complete on the field, but subsequent multi-angle replays reveal that the receiver only had one foot in bounds at the time of the catch and the opposing coach had thrown the challenge flag within the allowed time frame?  A) The touchdown is upheld. B) The touchdown is overturned and the pass is ruled incomplete. C) The play is ruled a fumble and the opposing team gains possession. D) The game clock is reset to the time of the contested catch.\nSub-Question 1: Under NFL rules, how many feet must a receiver have in bounds for a pass to be completed?  A) One foot. B) Two feet. C) Three feet. D) It depends on the receiver's position.\nSub-Question 2: In the NFL, within what time frame must a coach throw a challenge flag for a play to be eligible for a Replay Officials review?  A) Before the next play begins. B) Within two minutes of the play. C) Anytime before the two-minute warning. D) During the play in question.\n\nFor each question, provide the answer as a concatenation of the correct choices.\nSeparate the answers for the questions by comma.\nFor example, if the correct choices for the main question are A and C, for the first sub-question is D and for the second sub-question are B and D, your final answer must be \"AC, D, BD\".", "target": "B, B, A"}
        ]
    elif task_name == "temporal sequence":
        fewshot_examples = [
            {"input": "Alice and Bob work from 9 to 5 their local time on weekdays. They want to have a meeting some time this week.\n\nThe schedule for Alice's week in their local time is as follows:\nMonday: Booked at the following times: from 10:00 to 11:00, from 14:00 to 15:00\nTuesday: Booked at the following times: from 11:00 to 12:00\nWednesday: Booked at the following times: from 13:00 to 14:00\nThursday: Booked at the following times: from 10:00 to 11:00\nFriday: Booked at the following times: from 15:00 to 16:00\n\nThe schedule for Bob's week in their local time is as follows:\nMonday: Booked at the following times: from 9:00 to 10:00, from 15:00 to 16:00\nTuesday: Booked at the following times: from 12:00 to 13:00\nWednesday: Booked at the following times: from 14:00 to 15:00\nThursday: Booked at the following times: from 11:00 to 12:00\nFriday: Booked at the following times: from 13:00 to 14:00\n\nLet X be the length of the longest meeting (in minutes) that can be scheduled if the meeting has to start on the hour or half hour. Also, let Y be number of possible options of such meetings. Compute X and Y and report them separated by a comma (e.g., 45, 3). If X is 0, report 0, 0.", "target": "60, 2"},
            {"input": "Alice and Bob work from 9 to 5 their local time on weekdays. They want to have a meeting some time this week.\n\nThe schedule for Alice's week in their local time is as follows:\nMonday: Booked at the following times: from 10:00 to 11:00\nTuesday: Booked at the following times: from 11:00 to 12:00\nWednesday: Booked at the following times: from 12:00 to 13:00\n\nThe schedule for Bob's week in their local time is as follows:\nMonday: Booked at the following times: from 9:00 to 10:00\nTuesday: Booked at the following times: from 10:00 to 11:00\nWednesday: Booked at the following times: from 11:00 to 12:00\n\nLet X be the length of the longest meeting (in minutes) that can be scheduled if the meeting has to start on the hour or half hour. Also, let Y be number of possible options of such meetings. Compute X and Y and report them separated by a comma (e.g., 45, 3). If X is 0, report 0, 0.", "target": "60, 1"},
            {"input": "Alice and Bob work from 9 to 5 their local time on weekdays. They want to have a meeting some time this week.\n\nThe schedule for Alice's week in their local time is as follows:\nMonday: Booked at the following times: from 9:00 to 10:00, from 14:00 to 15:00\nTuesday: Booked at the following times: from 10:00 to 11:00\n\nThe schedule for Bob's week in their local time is as follows:\nMonday: Booked at the following times: from 10:00 to 11:00, from 15:00 to 16:00\nTuesday: Booked at the following times: from 9:00 to 10:00\n\nLet X be the length of the longest meeting (in minutes) that can be scheduled if the meeting has to start on the hour or half hour. Also, let Y be number of possible options of such meetings. Compute X and Y and report them separated by a comma (e.g., 45, 3). If X is 0, report 0, 0.", "target": "30, 2"}
        ]
    elif task_name == "shuffled objects":
        fewshot_examples = [
            {"input": "Alice, Bob, Claire, Dave, Eve, Fred, and Gertrude are friends and avid readers who occasionally trade books. At the start of the semester, they each buy one new book: Alice gets Moby Dick, Bob gets The Odyssey, Claire gets Ulysses, Dave gets The Fellowship of the Ring, Eve gets Lolita, Fred gets The Pearl, and Gertrude gets Catch-22. As the semester proceeds, they start trading around the new books. First, Dave and Claire swap books. Then, Alice and Dave swap books. Then, Fred and Claire swap books. Finally, Bob and Eve swap books. At the end of the semester, Claire has\nOptions:\n(A) Moby Dick\n(B) The Odyssey\n(C) Ulysses\n(D) The Fellowship of the Ring\n(E) Lolita\n(F) The Pearl\n(G) Catch-22", "target": "(F)"},
            {"input": "Alice, Bob, Claire, Dave, Eve, Fred, and Gertrude are dancers at a square dance. At the start of a song, they each have a partner: Alice is dancing with Rodrigo, Bob is dancing with Jamie, Claire is dancing with Patrick, Dave is dancing with Lola, Eve is dancing with Izzi, Fred is dancing with Melissa, and Gertrude is dancing with Karl. Throughout the song, the dancers often trade partners. First, Fred and Bob switch partners. Then, Fred and Claire switch partners. Then, Alice and Gertrude switch partners. Finally, Bob and Eve switch partners. At the end of the song, Bob is dancing with\nOptions:\n(A) Rodrigo\n(B) Jamie\n(C) Patrick\n(D) Lola\n(E) Izzi\n(F) Melissa\n(G) Karl", "target": "(E)"},
            {"input": "Alice, Bob, Claire, Dave, Eve, Fred, and Gertrude are playing a game. At the start of the game, they are each holding a ball: Alice has a black ball, Bob has a brown ball, Claire has a yellow ball, Dave has a purple ball, Eve has a blue ball, Fred has a orange ball, and Gertrude has a pink ball. As the game progresses, pairs of players trade balls. First, Bob and Claire swap balls. Then, Alice and Dave swap balls. Then, Gertrude and Claire swap balls. Finally, Bob and Eve swap balls. At the end of the game, Bob has\nOptions:\n(A) black ball\n(B) brown ball\n(C) yellow ball\n(D) purple ball\n(E) blue ball\n(F) orange ball\n(G) pink ball", "target": "(C)"}
        ]
    elif task_name == "web of lies":
        fewshot_examples = [
            {"input": "In this question, assume each person either always tells the truth or always lies. Alice is at the park. The person at the library says the person at the museum lies. The person at the museum says the person at the park tells the truth. Bob is at the restaurant. The person at the zoo says the person at the gallery tells the truth. The person at the airport says the person at the restaurant lies. The person at the park tells the truth. The person at the restaurant tells the truth. Does the person at the park tell the truth? Does the person at the library tell the truth? Does the person at the museum tell the truth? Your answer should be a list of three words separated by commas. Each of them must be either yes (if the person tells the truth), no (if the person lies), or unknown (if the person's truth cannot be determined). For example, <unknown, no, yes> or <yes, yes, yes>.", "target": "yes, no, yes"},
            {"input": "In this question, assume each person either always tells the truth or always lies. Person A is at location X. The person at location Y says the person at location Z lies. The person at location Z says the person at location X tells the truth. Person B is at location W. The person at location V says the person at location U tells the truth. The person at location T says the person at location W lies. The person at location X tells the truth. The person at location W tells the truth. Does the person at location X tell the truth? Does the person at location Y tell the truth? Does the person at location Z tell the truth? Your answer should be a list of three words separated by commas. Each of them must be either yes (if the person tells the truth), no (if the person lies), or unknown (if the person's truth cannot be determined). For example, <unknown, no, yes> or <yes, yes, yes>.", "target": "yes, no, yes"},
            {"input": "In this question, assume each person either always tells the truth or always lies. X is at place 1. The person at place 2 says the person at place 3 lies. The person at place 3 says the person at place 1 tells the truth. Y is at place 4. The person at place 5 says the person at place 6 tells the truth. The person at place 7 says the person at place 4 lies. The person at place 1 tells the truth. The person at place 4 tells the truth. Do the person at place 1, the person at place 2, and the person at place 3 tell the truth? Your answer should be a list of three words separated by commas. Each of them must be either yes (if the person tells the truth), no (if the person lies), or unknown (if the person's truth cannot be determined). For example, <unknown, no, yes> or <yes, yes, yes>.", "target": "yes, no, yes"}
        ]
    elif task_name == "boardgame qa":
        fewshot_examples = [
            {"input": "A few players are playing a boardgame. The current state of the game is as follows. The lion has 20 coins. The tiger has 30 coins. And the rules of the game are as follows. Rule1: If the lion has at least 40 coins, then the tiger has at least 40 coins. Rule2: If the tiger has at least 40 coins, then the game ends. Rule1 is preferred over Rule2. If a rule is preferred over the other, it means whenever both of them can be applied to derive new conclusions and those conclusions contradict with each other (e.g., from one we derive X and from the other we derive not X), we should go with the conclusion from the rule with higher preference. Based on the facts, rules, and preferences, what is the truth value of the statement, does the game ends? Answer 'proved' if it can be proved, 'disproved' if it can be disproved, and 'unknown' if it can neither be proved nor disproved.", "target": "disproved"},
            {"input": "A few players are playing a boardgame. The current state of the game is as follows. The cat is in the garden. The dog is in the house. And the rules of the game are as follows. Rule1: If the cat is in the garden, then the dog is in the house. Rule2: If the dog is in the house, then the bird flies away. Rule1 is preferred over Rule2. If a rule is preferred over the other, it means whenever both of them can be applied to derive new conclusions and those conclusions contradict with each other (e.g., from one we derive X and from the other we derive not X), we should go with the conclusion from the rule with higher preference. Based on the facts, rules, and preferences, what is the truth value of the statement, the bird flies away? Answer 'proved' if it can be proved, 'disproved' if it can be disproved, and 'unknown' if it can neither be proved nor disproved.", "target": "proved"},
            {"input": "A few players are playing a boardgame. The current state of the game is as follows. The knight has a sword. The wizard has a staff. And the rules of the game are as follows. Rule1: If the knight has a sword and the wizard has a staff, then they can fight. Rule2: If the knight has a sword, then the wizard has a staff. Rule1 is preferred over Rule2. If a rule is preferred over the other, it means whenever both of them can be applied to derive new conclusions and those conclusions contradict with each other (e.g., from one we derive X and from the other we derive not X), we should go with the conclusion from the rule with higher preference. Based on the facts, rules, and preferences, what is the truth value of the statement, the game ends? Answer 'proved' if it can be proved, 'disproved' if it can be disproved, and 'unknown' if it can neither be proved nor disproved.", "target": "unknown"}
        ]
    elif task_name == "buggy tables":
        fewshot_examples = [
            {"input": "I have a table with 5 rows (including the header) and 3 columns. The table was converted to markdown format as follows:\n\n| name | value | count |\n| --- | --- | --- |\n| A | 10 | 5 |\n| B | ERROR | 3 |\n| C | 30 | 2 |\n| D | 40 | null |\n\nHowever, the code to convert the table into markdown format was buggy and mistakenly replaced some values with \"ERROR\". The values for those cells in column-order are respectively as follows: [20]. Compute the average of the value column across all rows. Round the result to 2 decimal places. If a value is null, ignore it from the computations. If the average cannot be computed due to there being no values, the final answer must be \"0\".", "target": "25.0"},
            {"input": "I have a table with 6 rows (including the header) and 4 columns. The table was converted to markdown format as follows:\n\n| id | score | time | level |\n| --- | --- | --- | --- |\n| 1 | 100 | 60 | 1 |\n| 2 | ERROR | 120 | 2 |\n| 3 | 150 | null | 1 |\n| 4 | 250 | 150 | 3 |\n| 5 | ERROR | 110 | 2 |\n\nHowever, the code to convert the table into markdown format was buggy and mistakenly replaced some values with \"ERROR\". The values for those cells in column-order are respectively as follows: [200, 180]. Compute the median of the score column across all rows, only looking at the rows where level is greater than 1. Round the result to 2 decimal places. If it cannot be determined whether the condition is satisfied or not (e.g., due to null values that cannot be inferred from the rest of the table), assume the condition is not satisfied. If a value is null, ignore it from the computations. If the median cannot be computed due to there being no values, the final answer must be \"0\".", "target": "200.0"},
            {"input": "I have a table with 4 rows (including the header) and 3 columns. The table was converted to markdown format as follows:\n\n| item | price | quantity |\n| --- | --- | --- |\n| X | 15.5 | 10 |\n| Y | ERROR | 5 |\n| Z | 35.5 | null |\n\nHowever, the code to convert the table into markdown format was buggy and mistakenly replaced some values with \"ERROR\". The values for those cells in column-order are respectively as follows: [25.0]. Compute the absolute difference between the average of the price column and the average of the quantity column, only looking at the rows where price is greater than 20. Round the result to 2 decimal places. If it cannot be determined whether the condition is satisfied or not (e.g., due to null values that cannot be inferred from the rest of the table), assume the condition is not satisfied. If a value is null, ignore it from the computations. If any of the averages cannot be computed due to there being no values, the final answer must be \"0\".", "target": "5.0"}
        ]
    elif task_name == "dyck languages":
        fewshot_examples = [
            {"input": "You are an expert in a language called dyck where you must complete the language sequence of unclosed brackets of all types (e.g., [], {}, <>). You are given an initial initial dyck language sequence and the steps, provided as thoughts, that were used to arrive at the closing bracket sequence in the dyck language. Your job is to identify the first step that was a mistake in reasoning about the closing bracket sequence in dyck language, if any. This can be forgetting to close a bracket or closing with the wrong bracket or incorrectly copying the prior subsequence of closing brackets to the next step.\nTask: Complete the rest of the sequence, making sure that the parentheses are closed properly. Input: ( [ ) ]\nThought 1: We should process each input one by one and keep track of the stack configuration.\nThought 2: stack: empty\nThought 3: ( ; stack: (\nThought 4: [ ; stack: ( [\nThought 5: ) ; stack: (\nThought 6: ] ; stack: empty\nThought 7: Now, we have reached the end. The final stack is empty.\nThought 8: So the answer is\nQ: Is there a mistake in this sequence? Write \"No\" if there are no mistakes, or the number N if there is a mistake in Thought N.", "target": "5"},
            {"input": "You are an expert in a language called dyck where you must complete the language sequence of unclosed brackets of all types (e.g., [], {}, <>). You are given an initial initial dyck language sequence and the steps, provided as thoughts, that were used to arrive at the closing bracket sequence in the dyck language. Your job is to identify the first step that was a mistake in reasoning about the closing bracket sequence in dyck language, if any. This can be forgetting to close a bracket or closing with the wrong bracket or incorrectly copying the prior subsequence of closing brackets to the next step.\nTask: Complete the rest of the sequence, making sure that the parentheses are closed properly. Input: { [ ] }\nThought 1: We should process each input one by one and keep track of the stack configuration.\nThought 2: stack: empty\nThought 3: { ; stack: {\nThought 4: [ ; stack: { [\nThought 5: ] ; stack: {\nThought 6: } ; stack: empty\nThought 7: Now, we have reached the end. The final stack is empty.\nThought 8: So the answer is\nQ: Is there a mistake in this sequence? Write \"No\" if there are no mistakes, or the number N if there is a mistake in Thought N.", "target": "No"},
            {"input": "You are an expert in a language called dyck where you must complete the language sequence of unclosed brackets of all types (e.g., [], {}, <>). You are given an initial initial dyck language sequence and the steps, provided as thoughts, that were used to arrive at the closing bracket sequence in the dyck language. Your job is to identify the first step that was a mistake in reasoning about the closing bracket sequence in dyck language, if any. This can be forgetting to close a bracket or closing with the wrong bracket or incorrectly copying the prior subsequence of closing brackets to the next step.\nTask: Complete the rest of the sequence, making sure that the parentheses are closed properly. Input: < ( [ ] ) >\nThought 1: We should process each input one by one and keep track of the stack configuration.\nThought 2: stack: empty\nThought 3: < ; stack: <\nThought 4: ( ; stack: < (\nThought 5: [ ; stack: < ( [\nThought 6: ] ; stack: < (\nThought 7: ) ; stack: <\nThought 8: > ; stack: empty\nThought 9: Now, we have reached the end. The final stack is empty.\nThought 10: So the answer is\nQ: Is there a mistake in this sequence? Write \"No\" if there are no mistakes, or the number N if there is a mistake in Thought N.", "target": "No"}
        ]
    elif task_name == "linguini":
        fewshot_examples = [
            {"input": "The plural of English nouns is usually formed by adding the ending -s. But if the noun ends in s, x, z, ch, or sh, we add -es.\nHere are the singular and the plural forms of some English nouns and their translations. Some forms are missing.\n\nSingular | Plural | Translation\ncat | cats | gato\n dog | (1) | perro\nbox | boxes | caja\n(2) | churches | iglesia\n\nFill in the masked element indicated with (1), assuming the (1), (2), ... elements are masked out elements.", "target": "dogs"},
            {"input": "The following are words of Language X written in orthography, their phonetic transcriptions and English translations:\n\n1. cat | [kæt] | gato\n2. dog | [dɔg] | perro\n3. bird | [bɜrd] | pájaro\n4. fish | [fɪʃ] | pez\n\nTranscribe the following words:\nhouse | casa", "target": "[haʊs]"},
            {"input": "Here are some sentences in Language Y and their English translations:\n\n1. I see cat | I see the cat\n2. You see dog | You see the dog\n3. He sees bird | He sees the bird\n\nTranslate into English:\nShe sees fish", "target": "She sees the fish"}
        ]
    elif task_name == "multistep arithmetic":
        fewshot_examples = [
            {"input": "Consider the following new operations:\n\n$a & b$ equals $(a - b)$ if $a * b > 0$; otherwise, it equals $-a - -b$.\n$a >< b$ equals $(a - b)$ if $a * b > 0$; otherwise, it equals $a & b$.\n\nLet A = (5 & 3) >< 2\nLet B = (10 & 5) >< 3\nCompute A + B. Your final answer must be in number form.", "target": "7"},
            {"input": "Consider the following new operations:\n\n$a @ b$ equals $(a + b)$ if $a > b$; otherwise, it equals $(a - b)$.\n$a ~ b$ equals $(a * b)$ if $a + b > 10$; otherwise, it equals $(a / b)$.\n\nLet A = (8 @ 3) ~ 2\nLet B = (5 @ 7) ~ 4\nCompute A - B. Your final answer must be in number form.", "target": "9"},
            {"input": "Consider the following new operations:\n\n$a # b$ equals $a + b$ if both $a$ and $b$ are even; otherwise, it equals $a - b$.\n$a $ b$ equals $a * b$ if $a > 5$; otherwise, it equals $a + b$.\n\nLet A = (6 # 4) $ 3\nLet B = (3 # 5) $ 7\nCompute A + B. Your final answer must be in number form.", "target": "37"}
        ]
    elif task_name == "nycc":
        fewshot_examples = [
            {"input": "The following is a description of a funny cartoon for the New Yorker Caption Contest\n\n  Description: A dog is sitting at a desk with a computer, wearing glasses and looking serious.\n\n  Which of the following captions is the funniest?\n(A) Working from home has its challenges.\n(B) I need to speak with your manager.\n(C) This is my serious face.\n(D) Can I help you with something?\n(E) Just another day at the office.\n(F) I'm taking this very seriously.\n(G) Do you have any treats?\n(H) This is my professional look.\n(I) I'm here for the interview.\n(J) Can we discuss my benefits?", "target": "(A)"},
            {"input": "The following is a description of a funny cartoon for the New Yorker Caption Contest\n\n  Description: A cat is wearing a business suit and holding a briefcase, standing in an office.\n\n  Which of the following captions is the funniest?\n(A) I'm here for the interview.\n(B) This is my professional look.\n(C) Do you have any tuna?\n(D) I mean business.\n(E) Just another Monday.\n(F) I'm ready for my performance review.\n(G) Can we discuss my nap schedule?\n(H) I'm taking this very seriously.\n(I) This is my serious face.\n(J) I need to speak with your manager.", "target": "(C)"},
            {"input": "The following is a description of a funny cartoon for the New Yorker Caption Contest\n\n  Description: A bird is carrying a briefcase and wearing a tie, standing at a bus stop.\n\n  Which of the following captions is the funniest?\n(A) Early bird catches the worm.\n(B) Flying to work today.\n(C) This is my commute.\n(D) Just another day.\n(E) I'm running late.\n(F) I'm taking the early flight.\n(G) This is my professional look.\n(H) I need to speak with your manager.\n(I) Can we discuss my schedule?\n(J) I'm here for the interview.", "target": "(B)"}
        ]
    elif task_name == "object properties":
        fewshot_examples = [
            {"input": "I had a collection of 2 weird items that went through a few changes. Initially, I had a small German pen made of concrete with a smell of wet dog, an extra-large Brazilian saw made of glass with a smell of baking bread. The color of the items was respectively as follows: the first 1 was beige, the next 1 was black. Then, I lost one of the small items in my collection. In my current collection, how many items have the following attributes: either color is red, or size is small, or material is steel, or smell is pine needles, or origin is Russian? If the exact number cannot be computed, the answer must be \"unknown\".", "target": "1"},
            {"input": "I had a collection of 2 weird items that went through a few changes. Initially, I had an extra-small Chinese table made of concrete with a smell of rose, an extra-extra-large Portuguese house made of ceramic with a smell of freshly cut grass. The color of the items was respectively as follows: the first 1 was beige, the next 1 was blue. Then, I lost one of the medium items in my collection. In my current collection, how many items have the following attributes: color is not violet, size is not medium, material is not steel, smell is not freshly cut grass, and origin is not Portuguese? If the exact number cannot be computed, the answer must be \"unknown\".", "target": "2"},
            {"input": "I had a collection of 2 weird items that went through a few changes. Initially, I had an extra-large German clock made of glass with a smell of garlic, a small Mexican bird made of steel with a smell of garlic. The color of the items was respectively as follows: the first 1 was beige, the next 1 was black. Then, I lost one of the extra-large items in my collection. In my current collection, how many items have the following attributes: either color is ivory, or size is extra-large, or material is glass, or smell is popcorn, or origin is Russian? If the exact number cannot be computed, the answer must be \"unknown\".", "target": "1"}
        ]
    elif task_name == "sarc triples":
        fewshot_examples = [
            {"input": "Here are three (post, reply) pairs from Reddit. Your task is to decide whether each reply is sarcastic. Specifically, label each pair with a \"0\" or \"1\", wherea \"1\" indicates that the reply is sarcastic, and a \"0\" indicates that the reply does not contain sarcasm, and provide your final answer as a comma-separated set of labels (e.g., \"1,0,0\" or \"0,0,0\").\n\nPOST 1: I just spent 3 hours debugging this code.\nREPLY 1: Sounds like a productive afternoon!\n\nPOST 2: The weather is perfect today.\nREPLY 2: Yes, it's beautiful outside.\n\nPOST 3: I failed my exam.\nREPLY 3: That's really unfortunate, I'm sorry to hear that.", "target": "1,0,0"},
            {"input": "Here are three (post, reply) pairs from Reddit. Your task is to decide whether each reply is sarcastic. Specifically, label each pair with a \"0\" or \"1\", wherea \"1\" indicates that the reply is sarcastic, and a \"0\" indicates that the reply does not contain sarcasm, and provide your final answer as a comma-separated set of labels (e.g., \"1,0,0\" or \"0,0,0\").\n\nPOST 1: Traffic was terrible this morning.\nREPLY 1: Oh no, that must have been so enjoyable for you.\n\nPOST 2: I got a promotion at work.\nREPLY 2: Congratulations! That's wonderful news.\n\nPOST 3: The restaurant was completely empty.\nREPLY 3: Must be really popular then.", "target": "1,0,1"},
            {"input": "Here are three (post, reply) pairs from Reddit. Your task is to decide whether each reply is sarcastic. Specifically, label each pair with a \"0\" or \"1\", wherea \"1\" indicates that the reply is sarcastic, and a \"0\" indicates that the reply does not contain sarcasm, and provide your final answer as a comma-separated set of labels (e.g., \"1,0,0\" or \"0,0,0\").\n\nPOST 1: I love when it rains on my day off.\nREPLY 1: Yeah, that's exactly what everyone wants.\n\nPOST 2: The movie was really good.\nREPLY 2: I thought so too, great acting.\n\nPOST 3: My computer crashed again.\nREPLY 3: How convenient, right when you needed it most.", "target": "1,0,1"}
        ]
    elif task_name == "spatial reasoning":
        fewshot_examples = [
            {"input": "You have been given a circular path consisting of 8 connected dots. At the start, you are positioned on the dot that is located at the top of the path, where you find a laptop. Moving in a clockwise direction from the laptop, the elements on the path are a book, a pen, a phone, a cup, a lamp, a chair, and a table. Starting from the laptop, you move around the ring by 2 steps in a clockwise direction. What will you find? Your final answer must be only the object name (e.g., laptop). If you have not previously seen the object at the vertex, your final answer must be \"unknown\".", "target": "pen"},
            {"input": "You have been given a circular path consisting of 6 connected dots. At the start, you are positioned on the dot that is located at the top of the path, where you find a cat. Moving in a clockwise direction from the cat, the elements on the path are a dog, a bird, a fish, a rabbit, and a hamster. Starting from the bird, you move around the ring by 3 steps in a counter-clockwise direction. What will you find? Your final answer must be only the object name (e.g., laptop). If you have not previously seen the object at the vertex, your final answer must be \"unknown\".", "target": "rabbit"},
            {"input": "You have been given a circular path consisting of 10 connected dots. At the start, you are positioned on the dot that is located at the top of the path, where you find a star. Moving in a clockwise direction from the star, the elements on the path are a moon, a sun, a planet, a comet, an asteroid, a galaxy, a nebula, a black hole, and a quasar. Starting from the planet, you move around the ring by 4 steps in a clockwise direction, and then 2 steps in a counter-clockwise direction. What will you find? Your final answer must be only the object name (e.g., laptop). If you have not previously seen the object at the vertex, your final answer must be \"unknown\".", "target": "comet"}
        ]
    elif task_name == "time arithmetic":
        fewshot_examples = [
            {"input": "Let the answer to Question1 be X.\n\nQuestion1: The birthdate of Alice is 2000-Jan-01. Today is 2024-Jan-01. Compute the age of Alice in days. Your answer should be the number of days without the unit (for example, 233).\n\nLet the answer to Question2 be Y.\n\nQuestion2: Bob was born on 2010-02-15. Compute his age in days on 2020-02-14. Both dates are in yyyy-mm-dd format. Your answer should be the number of days without the unit (for example, 233).\n\nLet the answer to Question3 be Z.\n\nQuestion3: Charlie was born on 1995-06-10. Today is 2020-08-15. List the names of people who are older than 7000 days today, in alphabetical order. Your answer should be a list in the format [name1, name2, ...] (for example, [alice, bob]).", "target": "[alice, charlie]"},
            {"input": "Let the answer to Question1 be X, Y, Z.\n\nQuestion1: The average time taken to complete a task is 30 minutes and 15 seconds. Calculate the time taken to complete 5 tasks at the same rate. Your answer should be the value of X, Y, and Z, respectively (for example, 2, 5, 10).\n\nLet X' = X - 5, Y' = Y - 10, and Z' = Z - 15.\n\nQuestion2: On a certain day, Person A started working at X' hours Y' minutes, and worked for Z' hours. When did Person A finish working? Your answer should be in the format HH:MM (for example, 14:30).", "target": "02:32"},
            {"input": "Let the answer to Question1 be X.\n\nQuestion1: Sarah was born on 1995-06-10. Today is 2020-08-15. Compute Sarah's age in days. Your answer should be the number of days without the unit (for example, 233).\n\nQuestion2: Based on X from Question1, if someone was born X days before Sarah, what is their birthdate? Your answer should be in the format Month DD, YYYY (for example, January 15, 2000).", "target": "January 15, 1970"}
        ]
    elif task_name == "word sorting":
        fewshot_examples = [
            {"input": "You are an expert in word sorting. You will be provided with a list of words and the steps taken, in the form of thoughts, to arrange them in alphabetical order.\nYour job is to identify the first step that was a mistake in reasoning about the order of the words. This can be misunderstanding the order of the alphabet or getting the word or letter wrong or missing a word entirely.\nQ: Sort the following words alphabetically: List: cat apple banana\nThought 1: I should start by looking at the first letter of the words in the list. The first letter: \"cat\": \"c\" (3). \"apple\": \"a\" (1). \"banana\": \"b\" (2).\nThought 2: We now have: (1) \"apple\" < (2) \"banana\" < (3) \"cat\".\nThought 3: I have now sorted all the words. The answer is apple banana cat\nQ: Is there a mistake in this sequence? Write \"No\" if there are no mistakes, or the number N if there is a mistake in Thought N.", "target": "No"},
            {"input": "You are an expert in word sorting. You will be provided with a list of words and the steps taken, in the form of thoughts, to arrange them in alphabetical order.\nYour job is to identify the first step that was a mistake in reasoning about the order of the words. This can be misunderstanding the order of the alphabet or getting the word or letter wrong or missing a word entirely.\nQ: Sort the following words alphabetically: List: zebra ant dog\nThought 1: I should start by looking at the first letter of the words in the list. The first letter: \"zebra\": \"z\" (26). \"ant\": \"a\" (1). \"dog\": \"d\" (4).\nThought 2: We now have: (1) \"ant\" < (4) \"dog\" < (26) \"zebra\".\nThought 3: I have now sorted all the words. The answer is ant zebra dog\nQ: Is there a mistake in this sequence? Write \"No\" if there are no mistakes, or the number N if there is a mistake in Thought N.", "target": "3"},
            {"input": "You are an expert in word sorting. You will be provided with a list of words and the steps taken, in the form of thoughts, to arrange them in alphabetical order.\nYour job is to identify the first step that was a mistake in reasoning about the order of the words. This can be misunderstanding the order of the alphabet or getting the word or letter wrong or missing a word entirely.\nQ: Sort the following words alphabetically: List: moon sun star\nThought 1: I should start by looking at the first letter of the words in the list. The first letter: \"moon\": \"m\" (13). \"sun\": \"s\" (19). \"star\": \"s\" (19).\nThought 2: We now have: (13) \"moon\" < (19) [\"sun\" ? \"star\"].\nThought 3: Now let's sort this subpart [\"sun\" ? \"star\"] by looking at their second letters. The second letter: \"sun\": \"u\" (21). \"star\": \"t\" (20).\nThought 4: We now have: (20) \"star\" < (21) \"sun\" for the subpart. Hence, we have \"moon\" < \"star\" < \"sun\".\nThought 5: I have now sorted all the words. The answer is moon star sun\nQ: Is there a mistake in this sequence? Write \"No\" if there are no mistakes, or the number N if there is a mistake in Thought N.", "target": "No"},
        ]
    elif task_name == "zebra puzzles":
        fewshot_examples = [
            {"input": "There are 5 people next to each other in a row in positions 1, 2, 3, 4, 5 who have the following characteristics.\nEveryone is a different nationality: Chinese, American, British, French, German.\nEveryone lives in a different colored house: red, blue, green, yellow, white.\nEveryone drinks a different drink: coffee, tea, water, juice, milk.\nEveryone has a different pet: dog, cat, bird, fish, rabbit.\nEveryone drives a different car: Toyota, Honda, Ford, BMW, Mercedes.\nUsing the clues provided below, answer the question at the end.\nSome of clues provided might be irrelevant to the puzzle.\nClue 1: The person who lives in the red house is the Chinese.\nClue 2: The person who drinks coffee is next to the person who has a dog.\nClue 3: The person who drives a Toyota is at position 1.\nClue 4: The person who lives in the blue house is immediately to the left of the person who drinks tea.\nClue 5: The person who has a cat is the person who drives a Honda.\n\nQuestion: What position is the Chinese at?", "target": "3"},
            {"input": "There are 5 people next to each other in a row in positions 1, 2, 3, 4, 5 who have the following characteristics.\nEveryone supports a different NBA team: Bulls, Lakers, Warriors, Knicks, Celtics.\nEveryone likes a different food: pizza, pasta, burgers, sushi, tacos.\nEveryone has a different profession: doctor, teacher, engineer, lawyer, artist.\nEveryone owns a different car: Tesla, Audi, Lexus, BMW, Mercedes.\nUsing the clues provided below, answer the question at the end.\nSome of clues provided might be irrelevant to the puzzle.\nClue 1: The person who supports the Bulls is at position 1.\nClue 2: The person who likes pizza is next to the doctor.\nClue 3: The person who drives a Tesla is immediately to the left of the person who likes pasta.\nClue 4: The teacher is at one of the ends.\nClue 5: The person who supports the Lakers is next to the person who likes burgers.\n\nQuestion: What position is the person who likes sushi at?", "target": "4"},
            {"input": "There are 5 people next to each other in a row in positions 1, 2, 3, 4, 5 who have the following characteristics.\nEveryone has a different name: Alice, Bob, Charlie, David, Eve.\nEveryone likes a different sport: basketball, tennis, soccer, swimming, running.\nEveryone reads a different genre: mystery, fantasy, sci-fi, romance, thriller.\nEveryone drinks a different beverage: coffee, tea, juice, soda, water.\nUsing the clues provided below, answer the question at the end.\nSome of clues provided might be irrelevant to the puzzle.\nClue 1: Alice is at position 2.\nClue 2: The person who likes basketball is next to the person who reads mystery books.\nClue 3: The person who drinks coffee is immediately to the left of Bob.\nClue 4: The person who likes tennis is at one of the ends.\nClue 5: Charlie is next to the person who drinks water.\n\nQuestion: What position is the person who reads fantasy books at?", "target": "3"}
        ]
    else:
        # Generic fallback
        fewshot_examples = [
            {"input": f"Example 1 for {task_name}", "target": "Answer 1"},
            {"input": f"Example 2 for {task_name}", "target": "Answer 2"},
            {"input": f"Example 3 for {task_name}", "target": "Answer 3"}
        ]
    
    return fewshot_examples

def generate_report():
    """Generate the markdown report."""
    dataset_tasks, tasks_examples = load_bbeh_dataset()
    
    report_lines = []
    report_lines.append("# BBEH Tasks Fewshot Prompts Report\n")
    report_lines.append(f"Generated for all {len(dataset_tasks)} tasks in the BBEH dataset.\n")
    report_lines.append("## Overview\n")
    report_lines.append("This report lists all tasks in the BBEH dataset and provides fewshot prompt examples for each task.")
    report_lines.append("The fewshot examples are designed to demonstrate the task format without using actual dataset questions.\n")
    report_lines.append("")
    
    # List all tasks
    report_lines.append("## All BBEH Tasks\n")
    for i, task in enumerate(dataset_tasks, 1):
        count = len(tasks_examples.get(task, []))
        report_lines.append(f"{i}. **{task}** ({count} examples in dataset)")
    report_lines.append("")
    report_lines.append("---")
    report_lines.append("")
    
    # Generate fewshot prompts for each task
    report_lines.append("## Fewshot Prompts by Task\n")
    
    for task_name in dataset_tasks:
        report_lines.append(f"### {task_name}\n")
        
        # Show first 3 examples from dataset to understand format
        examples = tasks_examples.get(task_name, [])
        if examples:
            report_lines.append("#### First 3 Examples from Dataset:\n")
            for i, ex in enumerate(examples[:3], 1):
                report_lines.append(f"**Example {i}:**")
                report_lines.append("```")
                report_lines.append(f"Input: {ex['input']}")
                report_lines.append(f"Target: {ex['target']}")
                report_lines.append("```")
                report_lines.append("")
        
        # Generate fewshot prompts
        fewshot_examples = generate_fewshot_prompts(task_name, examples)
        
        report_lines.append("#### Suggested Fewshot Prompts:\n")
        report_lines.append("```yaml")
        report_lines.append("fewshot_config:")
        report_lines.append("  sampler: first_n")
        report_lines.append("  samples:")
        
        for i, ex in enumerate(fewshot_examples, 1):
            report_lines.append(f"  - input: {ex['input']}")
            report_lines.append(f"    target: '{ex['target']}'")
        
        report_lines.append("```")
        report_lines.append("")
        report_lines.append("---")
        report_lines.append("")
    
    return "\n".join(report_lines)

def main():
    print("=" * 80)
    print("BBEH Tasks Fewshot Prompts Report Generation")
    print("=" * 80)
    print()
    
    report = generate_report()
    
    # Write report
    report_file = SCRIPT_DIR / "BBEH_FEWSHOT_PROMPTS_REPORT.md"
    with open(report_file, 'w', encoding='utf-8') as f:
        f.write(report)
    
    print(f"Report generated: {report_file}")
    print()

if __name__ == "__main__":
    main()

